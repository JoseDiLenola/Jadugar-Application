# @jadugar/i18n Specification

This document specifies the internationalization system for the Jadugar framework. The i18n package provides comprehensive support for translations, locale management, RTL handling, and message formatting.

## I18n Architecture

### Translation Manager

```typescript
interface TranslationOptions {
  defaultLocale?: string;
  fallbackLocale?: string;
  loadPath?: string;
  cache?: boolean;
}

class TranslationManager {
  constructor(options?: TranslationOptions);
  
  // Translation Operations
  translate(key: string, params?: object): string;
  translatePlural(key: string, count: number): string;
  
  // Locale Management
  setLocale(locale: string): Promise<void>;
  getLocale(): string;
}
```

### Locale System

```typescript
interface LocaleOptions {
  direction?: 'ltr' | 'rtl';
  calendar?: 'gregory' | 'islamic' | 'buddhist';
  numberSystem?: string;
}

class LocaleManager {
  constructor(options?: LocaleOptions);
  
  // Locale Operations
  format(value: any, type: FormatType): string;
  parse(value: string, type: FormatType): any;
  
  // Direction Management
  setDirection(dir: 'ltr' | 'rtl'): void;
  getDirection(): string;
}
```

### Message Compiler

```typescript
interface MessageOptions {
  syntax?: 'icu' | 'simple';
  cache?: boolean;
  escapeHtml?: boolean;
}

class MessageCompiler {
  constructor(options?: MessageOptions);
  
  // Compilation
  compile(message: string): CompiledMessage;
  format(message: string, params: object): string;
  
  // Cache Management
  clearCache(): void;
  warmCache(messages: string[]): void;
}
```

## Implementation Notes

1. I18n Design
   - Translation management
   - Locale handling
   - Message compilation
   - Format handling

2. Performance
   - Message caching
   - Lazy loading
   - Bundle splitting
   - Memory usage

3. Features
   - Translation
   - Number formatting
   - Date formatting
   - RTL support

4. Integration
   - Component system
   - State management
   - Router system
   - Form system

5. Best Practices
   - Key organization
   - Bundle management
   - RTL handling
   - Format patterns

## I18n Requirements

1. Translation Management
   - Key resolution
   - Namespace support
   - Fallback chains
   - Interpolation

2. Locale Handling
   - Locale detection
   - Locale switching
   - Format handling
   - Calendar support

3. RTL Support
   - Direction management
   - Style flipping
   - Layout mirroring
   - Component adaptation

4. Message Formatting
   - ICU support
   - Plural rules
   - Number formats
   - Date formats

## Usage Examples

### Basic Translation

```typescript
// Create translation manager
const i18n = new TranslationManager({
  defaultLocale: 'en',
  fallbackLocale: 'en',
  loadPath: '/locales/{locale}/{namespace}.json'
});

// Load translations
await i18n.loadNamespace('common');

// Translate
const message = i18n.translate('common.welcome', {
  name: 'John'
});

// Plural translation
const count = 5;
const items = i18n.translatePlural('common.items', count, {
  count
});
```

### Locale Management

```typescript
// Create locale manager
const locale = new LocaleManager({
  direction: 'ltr',
  calendar: 'gregory',
  numberSystem: 'latn'
});

// Format values
const number = locale.format(1234.56, 'number', {
  style: 'currency',
  currency: 'USD'
});

const date = locale.format(new Date(), 'date', {
  dateStyle: 'full'
});

// Handle RTL
locale.setDirection('rtl');
document.dir = locale.getDirection();
```

### Message Compilation

```typescript
// Create message compiler
const compiler = new MessageCompiler({
  syntax: 'icu',
  cache: true
});

// Compile message
const template = compiler.compile(
  'Hello, {name}! You have {count, plural, =0 {no messages} one {# message} other {# messages}}.'
);

// Format message
const message = template.format({
  name: 'John',
  count: 5
});

// Pre-warm cache
compiler.warmCache([
  'common.welcome',
  'common.goodbye',
  'errors.notFound'
]);
```

### RTL Support

```typescript
// Create RTL manager
const rtl = new RTLManager({
  enabled: true,
  flip: true
});

// Register components
rtl.register(component, {
  properties: ['margin', 'padding', 'float'],
  values: ['left', 'right']
});

// Apply RTL
rtl.apply(element, {
  style: {
    marginLeft: '10px',
    paddingRight: '20px'
  }
});

// Mirror layout
rtl.mirror(container, {
  recursive: true,
  properties: ['flex-direction', 'text-align']
});
```
